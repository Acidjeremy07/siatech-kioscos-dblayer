import os
from pymongo import MongoClient

_cached = None

def get_db():
    global _cached
    if _cached:
        return _cached

    uri = os.getenv("MONGODB_URI")
    if not uri:
        raise RuntimeError("Env var MONGODB_URI is missing")

    client = MongoClient(uri, maxPoolSize=5)
    _cached = client["kioscoDB"]     # change db name if needed
    return _cached
